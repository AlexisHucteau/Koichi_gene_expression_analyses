---
title: "R Notebook"
output: html_notebook
---


```{r, include=F}
source("functions_methylation.R")

load("DATA/BMIQ_Koichi.RData")
load("DATA/pchic_DATA.RData")

DMR_analyses <- list()
Ranges_list <- list()
Clinical_patient_data <- read.csv("DATA/Clinical_patient_data.csv")
```


```{r, include=F}
DMR_analyses[["NR_R"]] <- DMR_analysis(as.matrix(BMIQ_Koichi), c("CR", "CRi"), "Good_Responders", c("SD", "PD"), "Bad_responders", Clinical_patient_data)

Ranges_list[["DMR_NR_R"]] <- GRanges(
  seqnames = DMR_analyses[["NR_R"]]$BumphunterDMR$seqnames,
  ranges = IRanges(start = DMR_analyses[["NR_R"]]$BumphunterDMR$start, end = DMR_analyses[["NR_R"]]$BumphunterDMR$end),
  Names = rownames(DMR_analyses[["NR_R"]]$BumphunterDMR),
  start_DMR = DMR_analyses[["NR_R"]]$BumphunterDMR$start,
  end_DMR = DMR_analyses[["NR_R"]]$BumphunterDMR$end
)

overlaps <- findOverlaps(Pchic_data[["GRanges"]], Ranges_list[["DMR_NR_R"]])
match_hit <- data.frame(mcols(Pchic_data[["GRanges"]][queryHits(overlaps),]),
                          data.frame(mcols(Ranges_list[["DMR_NR_R"]][subjectHits(overlaps),])))
```

